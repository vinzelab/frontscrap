//get json DB
var getDb=function(){
  var jsondb=require('../../db.json');
  // var count =Object.keys(jsondb).length;
  if(jsondb.length===0){
  jsondb=[];}
  return jsondb;
}

//check id between jsondb and json resp
var checkid=function(rep){
  var db=getDb();
  var date=new Date();
  if(db.length>0){
    for (var i=0;i<rep.length;i++){
      var isIn= false;
        for(var j=0;j<db.length;j++){
          if(rep[i].ref==db[j].ref){
            isIn=true;
            break;
            }
          }
  if (!isIn){
    rep[i].datescrap=date;
    db.splice(0,0,rep[i]);
    }
  }
  insertDb(db);
}
else{
  db=rep;
  insertDb(db);
  }
  // console.log(db);
}

var insertDb=function(db){
  var fs=require("fs");
  fs.writeFile('db.json',JSON.stringify(db), (err) => {
    if (err) throw err;
    console.log('It\'s saved!');
  });
}

var archiveEport=function(){

}
exports.checkid=checkid;
